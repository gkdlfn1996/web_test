{"ast":null,"code":"import _regenerator from \"/home/idea/td_test/LAZYPIC/PONO/web_test/fast_vue/frontend/node_modules/@babel/runtime/helpers/esm/regenerator.js\";\nimport _createForOfIteratorHelper from \"/home/idea/td_test/LAZYPIC/PONO/web_test/fast_vue/frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _asyncToGenerator from \"/home/idea/td_test/LAZYPIC/PONO/web_test/fast_vue/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _toConsumableArray from \"/home/idea/td_test/LAZYPIC/PONO/web_test/fast_vue/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.object.to-string.js\";\n// Types\n\nexport function useFileDrop() {\n  function hasFilesOrFolders(e) {\n    var _e$dataTransfer$items, _e$dataTransfer, _e$dataTransfer$files, _e$dataTransfer2;\n    var entries = _toConsumableArray((_e$dataTransfer$items = (_e$dataTransfer = e.dataTransfer) === null || _e$dataTransfer === void 0 ? void 0 : _e$dataTransfer.items) !== null && _e$dataTransfer$items !== void 0 ? _e$dataTransfer$items : []).filter(function (x) {\n      return x.kind === 'file';\n    }).map(function (x) {\n      return x.webkitGetAsEntry();\n    }).filter(Boolean);\n    return entries.length > 0 || _toConsumableArray((_e$dataTransfer$files = (_e$dataTransfer2 = e.dataTransfer) === null || _e$dataTransfer2 === void 0 ? void 0 : _e$dataTransfer2.files) !== null && _e$dataTransfer$files !== void 0 ? _e$dataTransfer$files : []).length > 0;\n  }\n  function handleDrop(_x) {\n    return _handleDrop.apply(this, arguments);\n  }\n  function _handleDrop() {\n    _handleDrop = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee(e) {\n      var _e$dataTransfer$items2, _e$dataTransfer3;\n      var result, entries, _iterator, _step, entry, files, _e$dataTransfer$files2, _e$dataTransfer4, _t;\n      return _regenerator().w(function (_context) {\n        while (1) switch (_context.n) {\n          case 0:\n            result = [];\n            entries = _toConsumableArray((_e$dataTransfer$items2 = (_e$dataTransfer3 = e.dataTransfer) === null || _e$dataTransfer3 === void 0 ? void 0 : _e$dataTransfer3.items) !== null && _e$dataTransfer$items2 !== void 0 ? _e$dataTransfer$items2 : []).filter(function (x) {\n              return x.kind === 'file';\n            }).map(function (x) {\n              return x.webkitGetAsEntry();\n            }).filter(Boolean);\n            if (!entries.length) {\n              _context.n = 9;\n              break;\n            }\n            _iterator = _createForOfIteratorHelper(entries);\n            _context.p = 1;\n            _iterator.s();\n          case 2:\n            if ((_step = _iterator.n()).done) {\n              _context.n = 5;\n              break;\n            }\n            entry = _step.value;\n            _context.n = 3;\n            return traverseFileTree(entry, appendIfDirectory('.', entry));\n          case 3:\n            files = _context.v;\n            result.push.apply(result, _toConsumableArray(files.map(function (x) {\n              return x.file;\n            })));\n          case 4:\n            _context.n = 2;\n            break;\n          case 5:\n            _context.n = 7;\n            break;\n          case 6:\n            _context.p = 6;\n            _t = _context.v;\n            _iterator.e(_t);\n          case 7:\n            _context.p = 7;\n            _iterator.f();\n            return _context.f(7);\n          case 8:\n            _context.n = 10;\n            break;\n          case 9:\n            result.push.apply(result, _toConsumableArray((_e$dataTransfer$files2 = (_e$dataTransfer4 = e.dataTransfer) === null || _e$dataTransfer4 === void 0 ? void 0 : _e$dataTransfer4.files) !== null && _e$dataTransfer$files2 !== void 0 ? _e$dataTransfer$files2 : []));\n          case 10:\n            return _context.a(2, result);\n        }\n      }, _callee, null, [[1, 6, 7, 8]]);\n    }));\n    return _handleDrop.apply(this, arguments);\n  }\n  return {\n    handleDrop: handleDrop,\n    hasFilesOrFolders: hasFilesOrFolders\n  };\n}\nfunction traverseFileTree(item) {\n  var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  return new Promise(function (resolve, reject) {\n    if (item.isFile) {\n      var fileEntry = item;\n      fileEntry.file(function (file) {\n        return resolve([{\n          file: file,\n          path: path\n        }]);\n      }, reject);\n    } else if (item.isDirectory) {\n      var directoryReader = item.createReader();\n      directoryReader.readEntries(/*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee2(entries) {\n          var files, _iterator2, _step2, entry, _t2, _t3, _t4, _t5, _t6, _t7;\n          return _regenerator().w(function (_context2) {\n            while (1) switch (_context2.n) {\n              case 0:\n                files = [];\n                _iterator2 = _createForOfIteratorHelper(entries);\n                _context2.p = 1;\n                _iterator2.s();\n              case 2:\n                if ((_step2 = _iterator2.n()).done) {\n                  _context2.n = 5;\n                  break;\n                }\n                entry = _step2.value;\n                _t2 = files.push;\n                _t3 = files;\n                _t4 = _toConsumableArray;\n                _context2.n = 3;\n                return traverseFileTree(entry, appendIfDirectory(path, entry));\n              case 3:\n                _t5 = _context2.v;\n                _t6 = _t4(_t5);\n                _t2.apply.call(_t2, _t3, _t6);\n              case 4:\n                _context2.n = 2;\n                break;\n              case 5:\n                _context2.n = 7;\n                break;\n              case 6:\n                _context2.p = 6;\n                _t7 = _context2.v;\n                _iterator2.e(_t7);\n              case 7:\n                _context2.p = 7;\n                _iterator2.f();\n                return _context2.f(7);\n              case 8:\n                resolve(files);\n              case 9:\n                return _context2.a(2);\n            }\n          }, _callee2, null, [[1, 6, 7, 8]]);\n        }));\n        return function (_x2) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    }\n  });\n}\nfunction appendIfDirectory(path, item) {\n  return item.isDirectory ? \"\".concat(path, \"/\").concat(item.name) : path;\n}","map":{"version":3,"names":["useFileDrop","hasFilesOrFolders","e","_e$dataTransfer$items","_e$dataTransfer","_e$dataTransfer$files","_e$dataTransfer2","entries","_toConsumableArray","dataTransfer","items","filter","x","kind","map","webkitGetAsEntry","Boolean","length","files","handleDrop","_x","_handleDrop","apply","arguments","_asyncToGenerator","_regenerator","m","_callee","_e$dataTransfer$items2","_e$dataTransfer3","result","_iterator","_step","entry","_e$dataTransfer$files2","_e$dataTransfer4","_t","w","_context","n","_createForOfIteratorHelper","p","s","done","value","traverseFileTree","appendIfDirectory","v","push","file","f","a","item","path","undefined","Promise","resolve","reject","isFile","fileEntry","isDirectory","directoryReader","createReader","readEntries","_ref","_callee2","_iterator2","_step2","_t2","_t3","_t4","_t5","_t6","_t7","_context2","call","_x2","concat","name"],"sources":["../../src/composables/fileDrop.ts"],"sourcesContent":["// Types\ntype FileSelection = { file: File, path: string }\n\nexport function useFileDrop () {\n  function hasFilesOrFolders (e: DragEvent): boolean {\n    const entries = [...e.dataTransfer?.items ?? []]\n      .filter(x => x.kind === 'file')\n      .map(x => x.webkitGetAsEntry())\n      .filter(Boolean)\n\n    return entries.length > 0 || [...e.dataTransfer?.files ?? []].length > 0\n  }\n\n  async function handleDrop (e: DragEvent) {\n    const result: File[] = []\n\n    const entries = [...e.dataTransfer?.items ?? []]\n      .filter(x => x.kind === 'file')\n      .map(x => x.webkitGetAsEntry())\n      .filter(Boolean)\n\n    if (entries.length) {\n      for (const entry of entries) {\n        const files = await traverseFileTree(entry!, appendIfDirectory('.', entry!))\n        result.push(...files.map(x => x.file))\n      }\n    } else {\n      result.push(...[...e.dataTransfer?.files ?? []])\n    }\n\n    return result\n  }\n\n  return {\n    handleDrop,\n    hasFilesOrFolders,\n  }\n}\n\nfunction traverseFileTree (item: FileSystemEntry, path = ''): Promise<FileSelection[]> {\n  return new Promise<FileSelection[]>((resolve, reject) => {\n    if (item.isFile) {\n      const fileEntry = item as FileSystemFileEntry\n      fileEntry.file((file: File) => resolve([{ file, path }]), reject)\n    } else if (item.isDirectory) {\n      const directoryReader = (item as FileSystemDirectoryEntry).createReader()\n      directoryReader.readEntries(async entries => {\n        const files = [] as FileSelection[]\n        for (const entry of entries) {\n          files.push(...(await traverseFileTree(entry, appendIfDirectory(path, entry))))\n        }\n        resolve(files)\n      })\n    }\n  })\n}\n\nfunction appendIfDirectory (path: string, item: FileSystemEntry) {\n  return item.isDirectory\n    ? `${path}/${item.name}`\n    : path\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}