{"ast":null,"code":"import _toConsumableArray from \"/home/idea/td_test/LAZYPIC/PONO/web_test/fast_vue/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _createForOfIteratorHelper from \"/home/idea/td_test/LAZYPIC/PONO/web_test/fast_vue/frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _regenerator from \"/home/idea/td_test/LAZYPIC/PONO/web_test/fast_vue/frontend/node_modules/@babel/runtime/helpers/esm/regenerator.js\";\nimport _asyncToGenerator from \"/home/idea/td_test/LAZYPIC/PONO/web_test/fast_vue/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.reverse.js\";\nimport \"core-js/modules/es.object.to-string.js\";\n// Utilities\nimport { shallowRef, watch } from 'vue';\n\n// Types\n\nexport function useScrolling(listRef, textFieldRef) {\n  var isScrolling = shallowRef(false);\n  var scrollTimeout;\n  function onListScroll(e) {\n    cancelAnimationFrame(scrollTimeout);\n    isScrolling.value = true;\n    scrollTimeout = requestAnimationFrame(function () {\n      scrollTimeout = requestAnimationFrame(function () {\n        isScrolling.value = false;\n      });\n    });\n  }\n  function finishScrolling() {\n    return _finishScrolling.apply(this, arguments);\n  }\n  function _finishScrolling() {\n    _finishScrolling = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee() {\n      return _regenerator().w(function (_context) {\n        while (1) switch (_context.n) {\n          case 0:\n            _context.n = 1;\n            return new Promise(function (resolve) {\n              return requestAnimationFrame(resolve);\n            });\n          case 1:\n            _context.n = 2;\n            return new Promise(function (resolve) {\n              return requestAnimationFrame(resolve);\n            });\n          case 2:\n            _context.n = 3;\n            return new Promise(function (resolve) {\n              return requestAnimationFrame(resolve);\n            });\n          case 3:\n            _context.n = 4;\n            return new Promise(function (resolve) {\n              if (isScrolling.value) {\n                var stop = watch(isScrolling, function () {\n                  stop();\n                  resolve();\n                });\n              } else resolve();\n            });\n          case 4:\n            return _context.a(2);\n        }\n      }, _callee);\n    }));\n    return _finishScrolling.apply(this, arguments);\n  }\n  function onListKeydown(_x) {\n    return _onListKeydown.apply(this, arguments);\n  }\n  function _onListKeydown() {\n    _onListKeydown = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee2(e) {\n      var _listRef$value;\n      var _textFieldRef$value, el, children, top, _iterator, _step, child, bottom, _iterator2, _step2, _child, _t, _t2;\n      return _regenerator().w(function (_context2) {\n        while (1) switch (_context2.n) {\n          case 0:\n            if (e.key === 'Tab') {\n              (_textFieldRef$value = textFieldRef.value) === null || _textFieldRef$value === void 0 || _textFieldRef$value.focus();\n            }\n            if (['PageDown', 'PageUp', 'Home', 'End'].includes(e.key)) {\n              _context2.n = 1;\n              break;\n            }\n            return _context2.a(2);\n          case 1:\n            el = (_listRef$value = listRef.value) === null || _listRef$value === void 0 ? void 0 : _listRef$value.$el;\n            if (el) {\n              _context2.n = 2;\n              break;\n            }\n            return _context2.a(2);\n          case 2:\n            if (e.key === 'Home' || e.key === 'End') {\n              el.scrollTo({\n                top: e.key === 'Home' ? 0 : el.scrollHeight,\n                behavior: 'smooth'\n              });\n            }\n            _context2.n = 3;\n            return finishScrolling();\n          case 3:\n            children = el.querySelectorAll(':scope > :not(.v-virtual-scroll__spacer)');\n            if (!(e.key === 'PageDown' || e.key === 'Home')) {\n              _context2.n = 11;\n              break;\n            }\n            top = el.getBoundingClientRect().top;\n            _iterator = _createForOfIteratorHelper(children);\n            _context2.p = 4;\n            _iterator.s();\n          case 5:\n            if ((_step = _iterator.n()).done) {\n              _context2.n = 7;\n              break;\n            }\n            child = _step.value;\n            if (!(child.getBoundingClientRect().top >= top)) {\n              _context2.n = 6;\n              break;\n            }\n            child.focus();\n            return _context2.a(3, 7);\n          case 6:\n            _context2.n = 5;\n            break;\n          case 7:\n            _context2.n = 9;\n            break;\n          case 8:\n            _context2.p = 8;\n            _t = _context2.v;\n            _iterator.e(_t);\n          case 9:\n            _context2.p = 9;\n            _iterator.f();\n            return _context2.f(9);\n          case 10:\n            _context2.n = 18;\n            break;\n          case 11:\n            bottom = el.getBoundingClientRect().bottom;\n            _iterator2 = _createForOfIteratorHelper(_toConsumableArray(children).reverse());\n            _context2.p = 12;\n            _iterator2.s();\n          case 13:\n            if ((_step2 = _iterator2.n()).done) {\n              _context2.n = 15;\n              break;\n            }\n            _child = _step2.value;\n            if (!(_child.getBoundingClientRect().bottom <= bottom)) {\n              _context2.n = 14;\n              break;\n            }\n            _child.focus();\n            return _context2.a(3, 15);\n          case 14:\n            _context2.n = 13;\n            break;\n          case 15:\n            _context2.n = 17;\n            break;\n          case 16:\n            _context2.p = 16;\n            _t2 = _context2.v;\n            _iterator2.e(_t2);\n          case 17:\n            _context2.p = 17;\n            _iterator2.f();\n            return _context2.f(17);\n          case 18:\n            return _context2.a(2);\n        }\n      }, _callee2, null, [[12, 16, 17, 18], [4, 8, 9, 10]]);\n    }));\n    return _onListKeydown.apply(this, arguments);\n  }\n  return {\n    onScrollPassive: onListScroll,\n    onKeydown: onListKeydown\n  }; // typescript doesn't know about vue's event merging\n}","map":{"version":3,"names":["shallowRef","watch","useScrolling","listRef","textFieldRef","isScrolling","scrollTimeout","onListScroll","e","cancelAnimationFrame","value","requestAnimationFrame","finishScrolling","_finishScrolling","apply","arguments","_asyncToGenerator","_regenerator","m","_callee","w","_context","n","Promise","resolve","stop","a","onListKeydown","_x","_onListKeydown","_callee2","_listRef$value","_textFieldRef$value","el","children","top","_iterator","_step","child","bottom","_iterator2","_step2","_child","_t","_t2","_context2","key","focus","includes","$el","scrollTo","scrollHeight","behavior","querySelectorAll","getBoundingClientRect","_createForOfIteratorHelper","p","s","done","v","f","_toConsumableArray","reverse","onScrollPassive","onKeydown"],"sources":["../../../src/components/VSelect/useScrolling.ts"],"sourcesContent":["// Utilities\nimport { shallowRef, watch } from 'vue'\n\n// Types\nimport type { Ref } from 'vue'\nimport type { VList } from '@/components/VList'\nimport type { VTextField } from '@/components/VTextField'\n\nexport function useScrolling (listRef: Ref<VList | undefined>, textFieldRef: Ref<VTextField | undefined>) {\n  const isScrolling = shallowRef(false)\n  let scrollTimeout: number\n  function onListScroll (e: Event) {\n    cancelAnimationFrame(scrollTimeout)\n    isScrolling.value = true\n    scrollTimeout = requestAnimationFrame(() => {\n      scrollTimeout = requestAnimationFrame(() => {\n        isScrolling.value = false\n      })\n    })\n  }\n  async function finishScrolling () {\n    await new Promise(resolve => requestAnimationFrame(resolve))\n    await new Promise(resolve => requestAnimationFrame(resolve))\n    await new Promise(resolve => requestAnimationFrame(resolve))\n    await new Promise<void>(resolve => {\n      if (isScrolling.value) {\n        const stop = watch(isScrolling, () => {\n          stop()\n          resolve()\n        })\n      } else resolve()\n    })\n  }\n  async function onListKeydown (e: KeyboardEvent) {\n    if (e.key === 'Tab') {\n      textFieldRef.value?.focus()\n    }\n\n    if (!['PageDown', 'PageUp', 'Home', 'End'].includes(e.key)) return\n    const el: HTMLElement = listRef.value?.$el\n    if (!el) return\n\n    if (e.key === 'Home' || e.key === 'End') {\n      el.scrollTo({\n        top: e.key === 'Home' ? 0 : el.scrollHeight,\n        behavior: 'smooth',\n      })\n    }\n\n    await finishScrolling()\n\n    const children = el.querySelectorAll(':scope > :not(.v-virtual-scroll__spacer)')\n\n    if (e.key === 'PageDown' || e.key === 'Home') {\n      const top = el.getBoundingClientRect().top\n      for (const child of children) {\n        if (child.getBoundingClientRect().top >= top) {\n          (child as HTMLElement).focus()\n          break\n        }\n      }\n    } else {\n      const bottom = el.getBoundingClientRect().bottom\n      for (const child of [...children].reverse()) {\n        if (child.getBoundingClientRect().bottom <= bottom) {\n          (child as HTMLElement).focus()\n          break\n        }\n      }\n    }\n  }\n\n  return {\n    onScrollPassive: onListScroll,\n    onKeydown: onListKeydown,\n  } as Record<string, Function> // typescript doesn't know about vue's event merging\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}